# =============================================================================
# Radius API Gateway Environment Configuration Example
# =============================================================================
# 复制此文件为 .env 并根据实际环境修改相应的值
# 注意：生产环境请确保敏感信息（如JWT密钥）的安全性

# =============================================================================
# 服务器配置
# =============================================================================
SERVER_NAME=API Gateway
SERVER_HOST=0.0.0.0
SERVER_PORT=8080
SERVER_DEBUG=true
SERVER_READ_TIMEOUT=30s
SERVER_WRITE_TIMEOUT=30s
SERVER_IDLE_TIMEOUT=120s

# =============================================================================
# 服务发现配置 (etcd)
# =============================================================================
ETCD_ADDRESS=localhost:2379
ETCD_TIMEOUT=5s

# =============================================================================
# RPC 客户端配置
# =============================================================================
CLIENT_CONNECTION_TIMEOUT=2s
CLIENT_REQUEST_TIMEOUT=60s
CLIENT_POOL_MAX_IDLE_PER_ADDRESS=10
CLIENT_POOL_MAX_IDLE_GLOBAL=100
CLIENT_POOL_MAX_IDLE_TIMEOUT=5m

# RPC 服务名称配置
IDENTITY_SRV_NAME=identity-service
# =============================================================================
# 中间件配置
# =============================================================================

# CORS 配置
CORS_ENABLED=true

# 限流配置
RATE_LIMIT_ENABLED=false
RATE_LIMIT_RPS=1000
RATE_LIMIT_BURST=2000

# JWT 认证配置
JWT_ENABLED=true
JWT_SIGNING_KEY=your-jwt-secret-key
JWT_TIMEOUT=30m
JWT_MAX_REFRESH=168h
JWT_REALM=API Gateway
JWT_TOKEN_LOOKUP=header:Authorization,cookie:auth_token,query:token
JWT_TOKEN_HEAD_NAME=Bearer
JWT_IDENTITY_KEY=identity
JWT_SEND_AUTHORIZATION=false

# JWT 跳过认证的路径（逗号分隔，无需认证的端点）
JWT_SKIP_PATHS=/api/v1/identity/auth/login,/api/v1/identity/auth/refresh,/ping,/health,/metrics,/swagger/*

# Cookie 配置（前后端分离架构）
# 重要：生产环境必须启用安全配置
JWT_COOKIE_SEND_COOKIE=true
JWT_COOKIE_COOKIE_NAME=auth_token
JWT_COOKIE_COOKIE_MAX_AGE=168h
JWT_COOKIE_COOKIE_DOMAIN=localhost
JWT_COOKIE_COOKIE_PATH=/
# SameSite 策略：strict（最严格）、lax（推荐）、none（需要 HTTPS）
JWT_COOKIE_COOKIE_SAME_SITE=lax
# 生产环境必须设为 true（仅 HTTPS）
JWT_COOKIE_SECURE_COOKIE=false
# 生产环境必须设为 true（防止 XSS 攻击，JavaScript 无法访问 Cookie）
JWT_COOKIE_HTTP_ONLY=true


# 错误处理中间件配置
ERROR_HANDLER_ENABLED=true
ERROR_HANDLER_ENABLE_DETAILED_ERRORS=false
ERROR_HANDLER_ENABLE_REQUEST_LOGGING=true
ERROR_HANDLER_ENABLE_RESPONSE_LOGGING=true
ERROR_HANDLER_ENABLE_PANIC_RECOVERY=true
ERROR_HANDLER_MAX_STACK_TRACE_SIZE=4096
ERROR_HANDLER_ENABLE_ERROR_METRICS=false
ERROR_HANDLER_ERROR_RESPONSE_TIMEOUT=5000

# =============================================================================
# Casbin 权限控制配置
# =============================================================================
CASBIN_ENABLED=false
CASBIN_SKIP_PATHS=/health,/metrics

# =============================================================================
# 日志配置
# =============================================================================
LOG_LEVEL=info
LOG_FORMAT=json
LOG_OUTPUT=stdout
# LOG_FILE_PATH 应指定完整路径（包括文件名），例如：/var/log/radius/api-gateway.log
LOG_FILE_PATH=/var/log/API Gateway.log
LOG_MAX_SIZE=100
LOG_MAX_AGE=30
LOG_MAX_BACKUPS=10

# =============================================================================
# 链路追踪配置
# =============================================================================
TRACING_ENABLED=false
TRACING_SERVICE_NAME=API Gateway
TRACING_ENDPOINT=http://localhost:14268/api/traces
TRACING_SAMPLER_RATIO=1.0

# =============================================================================
# 监控配置
# =============================================================================
METRICS_ENABLED=false
METRICS_PORT=9091
METRICS_PATH=/metrics

# =============================================================================
# DataLake 配置
# =============================================================================
DATALAKE_URL=http://localhost:8080

# =============================================================================
# Redis 配置
# =============================================================================
# Redis服务器地址
REDIS_ADDRESS=localhost:6379

# Redis密码（如果没有密码可以留空）
REDIS_PASSWORD=

# Redis数据库编号
REDIS_DB=0

# 连接池大小
REDIS_POOL_SIZE=10

# 最小空闲连接数
REDIS_MIN_IDLE_CONNS=5

# 最大重试次数
REDIS_MAX_RETRIES=3

# 连接超时时间
REDIS_DIAL_TIMEOUT=5s

# 读取超时时间
REDIS_READ_TIMEOUT=3s

# 写入超时时间
REDIS_WRITE_TIMEOUT=3s

# 连接池超时时间
REDIS_POOL_TIMEOUT=4s

# 空闲连接超时时间
REDIS_IDLE_TIMEOUT=5m

# 空闲连接检查频率
REDIS_IDLE_CHECK_FREQ=1m