# =============================================================================
#  Backend Services - Development Environment Variables
# =============================================================================
# 开发环境配置模板
#
# 使用说明：
#   1. 复制此文件为 .env：cp .env.dev.example .env
#   2. 根据需要修改配置值（开发环境通常使用默认值即可）
#   3. 使用 ./deploy.sh dev up 启动开发环境
#
# 注意：
#   - 开发环境使用弱密码，仅供本地开发使用
#   - 所有端口都映射到 localhost，便于调试
#   - 启用详细的日志和错误信息
# =============================================================================

# =============================================================================
# 全局配置
# =============================================================================
SERVER_DEBUG=true

# 日志配置
LOG_LEVEL=debug
LOG_FORMAT=json
LOG_OUTPUT=stdout

# 数据库配置
DB_TIMEZONE=Asia/Shanghai
DB_MAX_IDLE_CONNS=10
DB_MAX_OPEN_CONNS=100
DB_CONN_MAX_LIFETIME=3600
DB_CONN_MAX_IDLE_TIME=300

# 服务注册发现
ETCD_TIMEOUT=5

# =============================================================================
# 基础设施服务配置（开发环境）
# =============================================================================

## PostgreSQL - 使用默认密码（开发环境）
POSTGRES_USER=Admin
POSTGRES_PASSWORD=Admin
POSTGRES_DB=identity_srv
POSTGRES_PORT=5432

# 各服务数据库名称
IDENTITY_DB_NAME=identity_srv

## etcd
ETCD_PORT=2379

## RustFS - 使用默认密钥（开发环境）
RUSTFS_ACCESS_KEY=Admin
RUSTFS_SECRET_KEY=Admin
RUSTFS_CONSOLE_ENABLE="true"
# 注意：不设置 RUSTFS_SERVER_DOMAINS，使用默认的 Path Style 模式
RUSTFS_API_PORT=9000
RUSTFS_CONSOLE_PORT=9001

# =============================================================================
# Identity Service 配置
# =============================================================================
IDENTITY_SRV_NAME=identity-service
IDENTITY_SRV_HOST=0.0.0.0
IDENTITY_SRV_PORT=8891
IDENTITY_HEALTH_PORT=10000

# Logo 存储配置
LOGO_STORAGE_S3_ENDPOINT=http://rustfs:9000
LOGO_STORAGE_S3_PUBLIC_ENDPOINT=http://localhost:9000
LOGO_STORAGE_S3_REGION=us-east-1
LOGO_STORAGE_S3_USE_SSL=false
LOGO_STORAGE_USE_PATH_STYLE=true
LOGO_STORAGE_ACCESS_KEY=Admin
LOGO_STORAGE_SECRET_KEY=Admin
LOGO_STORAGE_MAX_FILE_SIZE=10485760
LOGO_STORAGE_ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,image/webp,image/svg+xml

# Casbin 配置
CASBIN_MODEL_PATH=./config/permission_model.conf
CASBIN_ENABLE_LOG=false
SUPER_ADMIN_ROLE_NAMES=super_admin,system_admin,root

# =============================================================================
# API Gateway 配置
# =============================================================================
API_GATEWAY_SERVER_NAME=api-gateway
API_GATEWAY_HOST=0.0.0.0
API_GATEWAY_PORT=8080

# 服务器超时配置
SERVER_READ_TIMEOUT=30s
SERVER_WRITE_TIMEOUT=30s
SERVER_IDLE_TIMEOUT=120s

# RPC 客户端配置
CLIENT_CONNECTION_TIMEOUT=2s
CLIENT_REQUEST_TIMEOUT=60s
CLIENT_POOL_MAX_IDLE_PER_ADDRESS=10
CLIENT_POOL_MAX_IDLE_GLOBAL=100
CLIENT_POOL_MAX_IDLE_TIMEOUT=5m

# 中间件配置
CORS_ENABLED=true
RATE_LIMIT_ENABLED=false
RATE_LIMIT_RPS=1000
RATE_LIMIT_BURST=2000

# JWT 配置 - 开发环境使用简单密钥
JWT_ENABLED=true
JWT_SIGNING_KEY=dev-secret-key-do-not-use-in-production
JWT_TIMEOUT=30m
JWT_MAX_REFRESH=168h
JWT_REALM= API Gateway
JWT_TOKEN_LOOKUP=header:Authorization,cookie:auth_token,query:token
JWT_TOKEN_HEAD_NAME=Bearer
JWT_IDENTITY_KEY=identity
JWT_SKIP_PATHS=/api/v1/identity/auth/login,/api/v1/identity/auth/refresh,/ping,/health,/metrics,/swagger/*

# Cookie 配置 - 开发环境
JWT_COOKIE_SEND_COOKIE=true
JWT_COOKIE_COOKIE_NAME=auth_token
JWT_COOKIE_COOKIE_MAX_AGE=168h
JWT_COOKIE_COOKIE_DOMAIN=localhost
JWT_COOKIE_COOKIE_PATH=/
JWT_COOKIE_COOKIE_SAME_SITE=lax
JWT_COOKIE_SECURE_COOKIE=false  # 开发环境可以使用 HTTP
JWT_COOKIE_HTTP_ONLY=true

# 错误处理配置 - 开发环境启用详细错误
ERROR_HANDLER_ENABLED=true
ERROR_HANDLER_ENABLE_DETAILED_ERRORS=true
ERROR_HANDLER_ENABLE_REQUEST_LOGGING=true
ERROR_HANDLER_ENABLE_RESPONSE_LOGGING=true
ERROR_HANDLER_ENABLE_PANIC_RECOVERY=true

# Casbin 权限控制
CASBIN_ENABLED=false
CASBIN_SKIP_PATHS=/health,/metrics,/ping

# 链路追踪配置（开发环境默认禁用）
TRACING_ENABLED=false
TRACING_SERVICE_NAME=api-gateway
TRACING_ENDPOINT=http://localhost:14268/api/traces
TRACING_SAMPLER_RATIO=1.0

# 监控配置（开发环境默认禁用）
METRICS_ENABLED=false
METRICS_PORT=9091
METRICS_PATH=/metrics
