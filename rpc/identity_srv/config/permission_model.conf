[request_definition]
r = sub, obj, act

[policy_definition]
# p: 权限策略 (role, resource, action)
p = role, resource, action

# p2: 角色菜单映射 (role_id, menu_id, permission)
p2 = role_id, menu_id, permission

[role_definition]
# g: 用户角色分配 (user_id, role_id)
g = _, _

[policy_effect]
e = some(where (p.eft == allow))

[matchers]
# 权限匹配：用户通过角色拥有对资源的操作权限, 如果是 SUPER_ADMIN 则拥有所有权限
m = (g(r.sub, p.role) && r.obj == p.resource && r.act == p.action) || g(r.sub, "SUPER_ADMIN")

# 菜单权限匹配：用户通过角色拥有菜单权限, 如果是 SUPER_ADMIN 则拥有所有权限
m2 = (g(r.sub, p2.role_id) && r.obj == p2.menu_id) || g(r.sub, "SUPER_ADMIN")